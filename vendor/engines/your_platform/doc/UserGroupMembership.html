<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: UserGroupMembership
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (U)</a> &raquo;
    
    
    <span class="title">UserGroupMembership</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: UserGroupMembership
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="DagLink.html" title="DagLink (class)">DagLink</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next"><span class='object_link'><a href="DagLink.html" title="DagLink (class)">DagLink</a></span></li>
          
            <li class="next">UserGroupMembership</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">app/models/user_group_membership.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>In this application, all user group memberships, i.e. memberships of a
certain user in a certail group, are stored implicitly in the dag_links
table in order to minimize the number of database queries that are
necessary to find out whether a user is member in a certain group through
an indirect membership.</p>

<p>This class allows abstract access to the UserGroupMemberships themselves,
and to their properties like since when the membership exists.</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="StatusGroupMembership.html" title="StatusGroupMembership (class)">StatusGroupMembership</a></span></p>
</div>







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-class_method" title="create (class method)">+ (Object) <strong>create</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a membership of the `u` in the group `g`.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_all_by-class_method" title="find_all_by (class method)">+ (Object) <strong>find_all_by</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find all memberships that match the given parameters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_all_by_group-class_method" title="find_all_by_group (class method)">+ (Object) <strong>find_all_by_group</strong>(group) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_all_by_user-class_method" title="find_all_by_user (class method)">+ (Object) <strong>find_all_by_user</strong>(user) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_all_by_user_and_group-class_method" title="find_all_by_user_and_group (class method)">+ (Object) <strong>find_all_by_user_and_group</strong>(user, group) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_by-class_method" title="find_by (class method)">+ (Object) <strong>find_by</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find the first membership that matches the parameters `params`.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_by_user_and_group-class_method" title="find_by_user_and_group (class method)">+ (Object) <strong>find_by_user_and_group</strong>(user, group) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#at_time-instance_method" title="#at_time (instance method)">- (Object) <strong>at_time</strong>(time) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the same membership as it was/is/will be at a certain point in time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#corporation-instance_method" title="#corporation (instance method)">- (Object) <strong>corporation</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>If this membership is a subgroup membership of a corporation, this method
will return the  corporation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at-instance_method" title="#created_at (instance method)">- (Object) <strong>created_at</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Timestamps Methods: Beginning and end of a membership</p>

<h6 id="label-.">.<span><a href="#label-.">&para;</a> <a href="#documentation">&uarr;</a></span></h6>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at%3D-instance_method" title="#created_at= (instance method)">- (Object) <strong>created_at=</strong>(created_at) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at_date-instance_method" title="#created_at_date (instance method)">- (Object) <strong>created_at_date</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method is used in the views, since it is more convenient just to edit
the date rather then date and time when specifying the date of joining a
group.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at_date%3D-instance_method" title="#created_at_date= (instance method)">- (Object) <strong>created_at_date=</strong>(created_at_date) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at_date_formatted-instance_method" title="#created_at_date_formatted (instance method)">- (Object) <strong>created_at_date_formatted</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at_date_formatted%3D-instance_method" title="#created_at_date_formatted= (instance method)">- (Object) <strong>created_at_date_formatted=</strong>(created_at_date_formatted) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete%21-instance_method" title="#delete! (instance method)">- (Object) <strong>delete!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This really deletes a membership from the database.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deleted%3F-instance_method" title="#deleted? (instance method)">- (Boolean) <strong>deleted?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Status Instance Methods</p>

<h6 id="label-.">.<span><a href="#label-.">&para;</a> <a href="#documentation">&uarr;</a></span></h6>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deleted_at-instance_method" title="#deleted_at (instance method)">- (Object) <strong>deleted_at</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deleted_at%3D-instance_method" title="#deleted_at= (instance method)">- (Object) <strong>deleted_at=</strong>(deleted_at) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy-instance_method" title="#destroy (instance method)">- (Object) <strong>destroy</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Destroy this membership, but reload the dataset from the database in order
to get access to the datetime of deletion.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy_direct_memberships-instance_method" title="#destroy_direct_memberships (instance method)">- (Object) <strong>destroy_direct_memberships</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is a helper to destroy all direct memberships of this membership.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#direct_groups-instance_method" title="#direct_groups (instance method)">- (Object) <strong>direct_groups</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the direct groups shown in the figures above in the description of
`direct_memberships`.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#direct_memberships-instance_method" title="#direct_memberships (instance method)">- (Object) <strong>direct_memberships</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the direct memberships corresponding to this membership (self).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#direct_memberships_now_and_in_the_past-instance_method" title="#direct_memberships_now_and_in_the_past (instance method)">- (Object) <strong>direct_memberships_now_and_in_the_past</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#first_created_direct_membership-instance_method" title="#first_created_direct_membership (instance method)">- (Object) <strong>first_created_direct_membership</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>In order to set and get the correct inherited datetime of creation and
deletion, one has to find the first created direct membership and the last
deleted  direct membership, as shown in the following schema.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#group-instance_method" title="#group (instance method)">- (Object) <strong>group</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_deleted_direct_membership-instance_method" title="#last_deleted_direct_membership (instance method)">- (Object) <strong>last_deleted_direct_membership</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_to_group-instance_method" title="#move_to_group (instance method)">- (Object) <strong>move_to_group</strong>(group_to_move_in) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Destroy the current membership and move the user over to the given group.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save-instance_method" title="#save (instance method)">- (Object) <strong>save</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Save the current membership and auto-save also the direct memberships
associated with the current (maybe indirect) membership.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#title-instance_method" title="#title (instance method)">- (Object) <strong>title</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Title, e.g.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#user-instance_method" title="#user (instance method)">- (Object) <strong>user</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Access Methods to Associated User and Group</p>

<h6 id="label-.">.<span><a href="#label-.">&para;</a> <a href="#documentation">&uarr;</a></span></h6>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create-class_method">
  
    + (<tt>Object</tt>) <strong>create</strong>(params) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a membership of the `u` in the group `g`.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_membership'>membership</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_g'>g</span> <span class='rparen'>)</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33
34
35
36
37
38
39
40
41
42</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 31</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Membership already exists: id = </span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not create UserGroupMembership without user.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span> <span class='symbol'>:user</span> <span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not create UserGroupMembership without group.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span> <span class='symbol'>:group</span> <span class='rbracket'>]</span>
    <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span> <span class='symbol'>:user</span> <span class='rbracket'>]</span>
    <span class='id identifier rubyid_group'>group</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span> <span class='symbol'>:group</span> <span class='rbracket'>]</span>
    <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_parent_groups'>parent_groups</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_group'>group</span>
    <span class='kw'>return</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_all_by-class_method">
  
    + (<tt>Object</tt>) <strong>find_all_by</strong>(params) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find all memberships that match the given parameters. This method returns
an ActiveRecord::Relation object, which means that the result can be
chained with scope methods.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_u'>u</span> <span class='rparen'>)</span>
<span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>group:</span> <span class='id identifier rubyid_g'>g</span> <span class='rparen'>)</span>
<span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_g'>g</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_g'>g</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_in_the_past'>in_the_past</span>
<span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_g'>g</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_now_and_in_the_past'>now_and_in_the_past</span>
<span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_g'>g</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with_deleted'>with_deleted</span>  <span class='comment'># same as .now_and_in_the_past</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 59</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span> <span class='symbol'>:user</span> <span class='rbracket'>]</span>
  <span class='id identifier rubyid_group'>group</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span> <span class='symbol'>:group</span> <span class='rbracket'>]</span>
  <span class='id identifier rubyid_links'>links</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>
</span><span class='id identifier rubyid_    .where'>    .where</span><span class='lparen'>(</span> <span class='symbol'>:descendant_type</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>User</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span><span class='period'>
</span><span class='id identifier rubyid_    .where'>    .where</span><span class='lparen'>(</span> <span class='symbol'>:ancestor_type</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Group</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_links'>links</span> <span class='op'>=</span> <span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span> <span class='symbol'>:descendant_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_user'>user</span>
  <span class='id identifier rubyid_links'>links</span> <span class='op'>=</span> <span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span> <span class='symbol'>:ancestor_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group'>group</span>
  <span class='id identifier rubyid_links'>links</span> <span class='op'>=</span> <span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span> <span class='symbol'>:created_at</span> <span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_links'>links</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_all_by_group-class_method">
  
    + (<tt>Object</tt>) <strong>find_all_by_group</strong>(group) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 83</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by_group'>find_all_by_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>group:</span> <span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_all_by_user-class_method">
  
    + (<tt>Object</tt>) <strong>find_all_by_user</strong>(user) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 79</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by_user'>find_all_by_user</span><span class='lparen'>(</span> <span class='id identifier rubyid_user'>user</span> <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_user'>user</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_all_by_user_and_group-class_method">
  
    + (<tt>Object</tt>) <strong>find_all_by_user_and_group</strong>(user, group) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 91</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by_user_and_group'>find_all_by_user_and_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_by-class_method">
  
    + (<tt>Object</tt>) <strong>find_by</strong>(params) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find the first membership that matches the parameters `params`. This is a
shortcut for `find_all_by( params ).first`. Use this, if you only expect
one membership to be found.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 75</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by'>find_all_by</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span> <span class='int'>1</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_by_user_and_group-class_method">
  
    + (<tt>Object</tt>) <strong>find_by_user_and_group</strong>(user, group) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 87</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_by_user_and_group'>find_by_user_and_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="at_time-instance_method">
  
    - (<tt>Object</tt>) <strong>at_time</strong>(time) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the same membership as it was/is/will be at a certain point in time.
This can be used, for example to get one or more memberships at a certain
point in time. This is a scope method and can be chained to other
ActiveRecord::Relation objects.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by_user'>find_all_by_user</span><span class='lparen'>(</span> <span class='id identifier rubyid_u'>u</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_time'>at_time</span><span class='lparen'>(</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_hour'>hour</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span> <span class='rparen'>)</span>
<span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_all_by_user'>find_all_by_user</span><span class='lparen'>(</span> <span class='id identifier rubyid_u'>u</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_time'>at_time</span><span class='lparen'>(</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_hour'>hour</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
<span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_g'>g</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_time'>at_time</span><span class='lparen'>(</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span> <span class='op'>+</span> <span class='int'>30</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 116</span>

<span class='kw'>def</span> <span class='id identifier rubyid_at_time'>at_time</span><span class='lparen'>(</span> <span class='id identifier rubyid_time'>time</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>
</span><span class='id identifier rubyid_    .find_all_by'>    .find_all_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span><span class='period'>
</span><span class='id identifier rubyid_    .with_deleted'>    .with_deleted</span><span class='period'>
</span><span class='id identifier rubyid_    .where'>    .where</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>created_at &lt; ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_time'>time</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deleted_at IS NULL OR deleted_at &gt; ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_time'>time</span> <span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>==</span> <span class='int'>0</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_memberships'>memberships</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="corporation-instance_method">
  
    - (<tt>Object</tt>) <strong>corporation</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>If this membership is a subgroup membership of a corporation, this method
will return the  corporation. Otherwise, this will return nil.</p>

<p>corporation</p>

<pre class="code ruby"><code class="ruby">|-------- group 
            |---( membership )---- user

membership = UserGroupMembership.find_by_user_and_group( user, group )
membership.corporation == corporation</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


250
251
252
253
254</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 250</span>

<span class='kw'>def</span> <span class='id identifier rubyid_corporation'>corporation</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span> <span class='op'>&amp;&amp;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>
    <span class='lparen'>(</span> <span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_ancestor_groups'>ancestor_groups</span> <span class='op'>+</span> <span class='lbracket'>[</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span> <span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_corporations'>corporations</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="created_at-instance_method">
  
    - (<tt>Object</tt>) <strong>created_at</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Timestamps Methods: Beginning and end of a membership</p>

<h6 id="label-"><span><a href="#label-">&para;</a> <a href="#documentation">&uarr;</a></span></h6>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_created_at'>created_at</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span> <span class='symbol'>:created_at</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_direct?'>direct?</span>
  <span class='id identifier rubyid_first_created_direct_membership'>first_created_direct_membership</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span> <span class='kw'>if</span> <span class='id identifier rubyid_first_created_direct_membership'>first_created_direct_membership</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="created_at=-instance_method">
  
    - (<tt>Object</tt>) <strong>created_at=</strong>(created_at) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 194</span>

<span class='kw'>def</span> <span class='id identifier rubyid_created_at='>created_at=</span><span class='lparen'>(</span> <span class='id identifier rubyid_created_at'>created_at</span> <span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>super</span><span class='lparen'>(</span> <span class='id identifier rubyid_created_at'>created_at</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_direct?'>direct?</span>
  <span class='id identifier rubyid_first_created_direct_membership'>first_created_direct_membership</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span> <span class='op'>=</span> <span class='id identifier rubyid_created_at'>created_at</span> <span class='kw'>if</span> <span class='id identifier rubyid_first_created_direct_membership'>first_created_direct_membership</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="created_at_date-instance_method">
  
    - (<tt>Object</tt>) <strong>created_at_date</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method is used in the views, since it is more convenient just to edit
the date rather then date and time when specifying the date of joining a
group.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


211
212
213</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 211</span>

<span class='kw'>def</span> <span class='id identifier rubyid_created_at_date'>created_at_date</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span><span class='period'>.</span><span class='id identifier rubyid_to_date'>to_date</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="created_at_date=-instance_method">
  
    - (<tt>Object</tt>) <strong>created_at_date=</strong>(created_at_date) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 214</span>

<span class='kw'>def</span> <span class='id identifier rubyid_created_at_date='>created_at_date=</span><span class='lparen'>(</span> <span class='id identifier rubyid_created_at_date'>created_at_date</span> <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span> <span class='op'>=</span> <span class='id identifier rubyid_created_at_date'>created_at_date</span><span class='period'>.</span><span class='id identifier rubyid_to_datetime'>to_datetime</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="created_at_date_formatted-instance_method">
  
    - (<tt>Object</tt>) <strong>created_at_date_formatted</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


217
218
219</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 217</span>

<span class='kw'>def</span> <span class='id identifier rubyid_created_at_date_formatted'>created_at_date_formatted</span>
  <span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_localize'>localize</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_created_at_date'>created_at_date</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="created_at_date_formatted=-instance_method">
  
    - (<tt>Object</tt>) <strong>created_at_date_formatted=</strong>(created_at_date_formatted) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


220
221
222</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 220</span>

<span class='kw'>def</span> <span class='id identifier rubyid_created_at_date_formatted='>created_at_date_formatted=</span><span class='lparen'>(</span> <span class='id identifier rubyid_created_at_date_formatted'>created_at_date_formatted</span> <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_created_at_date'>created_at_date</span> <span class='op'>=</span> <span class='id identifier rubyid_created_at_date_formatted'>created_at_date_formatted</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete!-instance_method">
  
    - (<tt>Object</tt>) <strong>delete!</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This really deletes a membership from the database.  Since this won&#39;t
call any callbacks, the links depending on this one are not updated,
meaning for reasons of database consistency, this is not to be run on 
links where deleted_at == nil.  If you really delete a link, you have to
use these two methods:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_link'>link</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>  <span class='comment'># now it has a :deleted_at and all dependent links are updated
</span><span class='id identifier rubyid_link'>link</span><span class='period'>.</span><span class='id identifier rubyid_delete!'>delete!</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173
174
175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_deleted_at'>deleted_at</span>
    <span class='const'>DagLink</span><span class='period'>.</span><span class='id identifier rubyid_delete_all!'>delete_all!</span><span class='lparen'>(</span> <span class='label'>id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rparen'>)</span> 
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>for reasons of database consistency, you have to call destroy() first and then delete!().</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deleted?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>deleted?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Status Instance Methods</p>

<h6 id="label-"><span><a href="#label-">&para;</a> <a href="#documentation">&uarr;</a></span></h6>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 182</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deleted_at-instance_method">
  
    - (<tt>Object</tt>) <strong>deleted_at</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 199</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deleted_at'>deleted_at</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span> <span class='symbol'>:deleted_at</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_direct?'>direct?</span>
  <span class='id identifier rubyid_last_deleted_direct_membership'>last_deleted_direct_membership</span><span class='period'>.</span><span class='id identifier rubyid_deleted_at'>deleted_at</span> <span class='kw'>if</span> <span class='id identifier rubyid_last_deleted_direct_membership'>last_deleted_direct_membership</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deleted_at=-instance_method">
  
    - (<tt>Object</tt>) <strong>deleted_at=</strong>(deleted_at) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 203</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deleted_at='>deleted_at=</span><span class='lparen'>(</span> <span class='id identifier rubyid_deleted_at'>deleted_at</span> <span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>super</span><span class='lparen'>(</span> <span class='id identifier rubyid_deleted_at'>deleted_at</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_direct?'>direct?</span>
  <span class='id identifier rubyid_last_deleted_direct_membership'>last_deleted_direct_membership</span><span class='period'>.</span><span class='id identifier rubyid_deleted_at'>deleted_at</span> <span class='op'>=</span> <span class='id identifier rubyid_deleted_at'>deleted_at</span> <span class='kw'>if</span> <span class='id identifier rubyid_last_deleted_direct_membership'>last_deleted_direct_membership</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="destroy-instance_method">
  
    - (<tt>Object</tt>) <strong>destroy</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Destroy this membership, but reload the dataset from the database in order
to get access to the datetime of deletion.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy'>destroy</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_destroyable?'>destroyable?</span>
    <span class='kw'>super</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_destroy_direct_memberships'>destroy_direct_memberships</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reload'>reload</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="destroy_direct_memberships-instance_method">
  
    - (<tt>Object</tt>) <strong>destroy_direct_memberships</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This is a helper to destroy all direct memberships of this membership. This
is called in #destroy.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 156</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy_direct_memberships'>destroy_direct_memberships</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_direct_membership'>direct_membership</span> <span class='kw'>in</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_direct_memberships'>direct_memberships</span>
    <span class='id identifier rubyid_direct_membership'>direct_membership</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="direct_groups-instance_method">
  
    - (<tt>Object</tt>) <strong>direct_groups</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the direct groups shown in the figures above in the description of
`direct_memberships`.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


301
302
303</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 301</span>

<span class='kw'>def</span> <span class='id identifier rubyid_direct_groups'>direct_groups</span>
  <span class='id identifier rubyid_direct_memberships'>direct_memberships</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_membership'>membership</span><span class='op'>|</span> <span class='id identifier rubyid_membership'>membership</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="direct_memberships-instance_method">
  
    - (<tt>Object</tt>) <strong>direct_memberships</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the direct memberships corresponding to this membership (self). For
clarification, consider the following structure:</p>

<pre class="code ruby"><code class="ruby">group1
  |---- group2
          |---- user</code></pre>

<p>user is not a direct member of group1, but an indirect member. But user is
a direct member of group2. Thus, this method, called on a membership of
user and group1 will return the membership between user and group2.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_group1'>group1</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_direct_memberships'>direct_memberships</span><span class='period'>.</span><span class='id identifier rubyid_should'>should</span> 
  <span class='id identifier rubyid_include'>include</span><span class='lparen'>(</span> <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_group2'>group2</span> <span class='rparen'>)</span> <span class='rparen'>)</span></code></pre>

<p>An indirect membership can also have several direct memberships, as shown
in this figure:</p>

<pre class="code ruby"><code class="ruby">group1
  |--------------- group2
  |                  |
  |---- group3       |
          |------------- user</code></pre>

<p>Here, group2 and grou3 are children of group1. user is member of group2 and
group3. Hence, the indirect membership of user and group1 will include both
direct memberships.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


285
286
287
288
289
290
291
292
293
294
295
296</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 285</span>

<span class='kw'>def</span> <span class='id identifier rubyid_direct_memberships'>direct_memberships</span>
  <span class='id identifier rubyid_descendant_groups_of_self_group'>descendant_groups_of_self_group</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_descendant_groups'>descendant_groups</span>
  <span class='id identifier rubyid_descendant_group_ids_of_self_group'>descendant_group_ids_of_self_group</span> <span class='op'>=</span> <span class='id identifier rubyid_descendant_groups_of_self_group'>descendant_groups_of_self_group</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_group_ids'>group_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_descendant_group_ids_of_self_group'>descendant_group_ids_of_self_group</span> <span class='op'>+</span> <span class='lbracket'>[</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbracket'>]</span>
  <span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='const'>UserGroupMembership</span><span class='period'>
</span><span class='id identifier rubyid_    .find_all_by_user'>    .find_all_by_user</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span> <span class='rparen'>)</span><span class='period'>
</span><span class='id identifier rubyid_    .where'>    .where</span><span class='lparen'>(</span> <span class='symbol'>:direct</span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rparen'>)</span><span class='period'>
</span><span class='id identifier rubyid_    .where'>    .where</span><span class='lparen'>(</span> <span class='symbol'>:ancestor_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_group_ids'>group_ids</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_with_deleted'>with_deleted</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span> <span class='symbol'>:deleted_at</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_memberships'>memberships</span> <span class='op'>=</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span> <span class='symbol'>:created_at</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_memberships'>memberships</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="direct_memberships_now_and_in_the_past-instance_method">
  
    - (<tt>Object</tt>) <strong>direct_memberships_now_and_in_the_past</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


305
306
307</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 305</span>

<span class='kw'>def</span> <span class='id identifier rubyid_direct_memberships_now_and_in_the_past'>direct_memberships_now_and_in_the_past</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_direct_memberships'>direct_memberships</span><span class='period'>.</span><span class='id identifier rubyid_now_and_in_the_past'>now_and_in_the_past</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="first_created_direct_membership-instance_method">
  
    - (<tt>Object</tt>) <strong>first_created_direct_membership</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>In order to set and get the correct inherited datetime of creation and
deletion, one has to find the first created direct membership and the last
deleted  direct membership, as shown in the following schema.</p>

<pre class="code ruby"><code class="ruby">A1                                                      A2
|-- indirect membership ----------------------------------|

b1                          b2
|-- direct membership 1 -----|
                             |-- direct membership 2 -----|
                             c1                         c2</code></pre>

<p>The following datetimes should be the same: A1 = b1,  A2 = c2,  b2 = c1</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


326
327
328
329
330
331</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 326</span>

<span class='kw'>def</span> <span class='id identifier rubyid_first_created_direct_membership'>first_created_direct_membership</span>
  <span class='kw'>unless</span> <span class='ivar'>@first_created_direct_membership</span>
    <span class='ivar'>@first_created_direct_membership</span> <span class='op'>=</span> <span class='id identifier rubyid_direct_memberships'>direct_memberships</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span> <span class='symbol'>:created_at</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>
  <span class='ivar'>@first_created_direct_membership</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="group-instance_method">
  
    - (<tt>Object</tt>) <strong>group</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 232</span>

<span class='kw'>def</span> <span class='id identifier rubyid_group'>group</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ancestor'>ancestor</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="last_deleted_direct_membership-instance_method">
  
    - (<tt>Object</tt>) <strong>last_deleted_direct_membership</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


333
334
335
336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 333</span>

<span class='kw'>def</span> <span class='id identifier rubyid_last_deleted_direct_membership'>last_deleted_direct_membership</span>
  <span class='kw'>unless</span> <span class='ivar'>@last_deleted_direct_membership</span>
    <span class='ivar'>@last_deleted_direct_membership</span> <span class='op'>=</span> <span class='id identifier rubyid_direct_memberships'>direct_memberships</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span> <span class='symbol'>:deleted_at</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>
  <span class='ivar'>@last_deleted_direct_membership</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_to_group-instance_method">
  
    - (<tt>Object</tt>) <strong>move_to_group</strong>(group_to_move_in) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Destroy the current membership and move the user over to the given group.</p>

<pre class="ruby"><span class="ruby-identifier">group1</span>                       <span class="ruby-identifier">group2</span>
  <span class="ruby-operator">|</span><span class="ruby-operator">-</span><span class="ruby-operator">-</span><span class="ruby-operator">-</span><span class="ruby-operator">-</span> <span class="ruby-identifier">user</span>       =<span class="ruby-operator">&gt;</span>          <span class="ruby-operator">|</span><span class="ruby-operator">-</span><span class="ruby-operator">-</span><span class="ruby-operator">-</span><span class="ruby-operator">-</span> <span class="ruby-identifier">user</span>
</pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


349
350
351
352
353</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 349</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_to_group'>move_to_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_group_to_move_in'>group_to_move_in</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_user_to_move'>user_to_move</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='const'>UserGroupMembership</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span> <span class='label'>user:</span> <span class='id identifier rubyid_user_to_move'>user_to_move</span><span class='comma'>,</span> <span class='label'>group:</span> <span class='id identifier rubyid_group_to_move_in'>group_to_move_in</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="save-instance_method">
  
    - (<tt>Object</tt>) <strong>save</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Save the current membership and auto-save also the direct memberships
associated with the current (maybe indirect) membership.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


133
134
135
136
137
138
139</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 133</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save'>save</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_direct?'>direct?</span>
    <span class='id identifier rubyid_first_created_direct_membership'>first_created_direct_membership</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span> <span class='kw'>if</span> <span class='id identifier rubyid_first_created_direct_membership'>first_created_direct_membership</span>
    <span class='id identifier rubyid_last_deleted_direct_membership'>last_deleted_direct_membership</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span> <span class='kw'>if</span> <span class='id identifier rubyid_last_deleted_direct_membership'>last_deleted_direct_membership</span>
  <span class='kw'>end</span>
  <span class='kw'>super</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="title-instance_method">
  
    - (<tt>Object</tt>) <strong>title</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Title, e.g. &#39;Membership of John Doe in GroupXY&#39;</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 19</span>

<span class='kw'>def</span> <span class='id identifier rubyid_title'>title</span>
  <span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_translate'>translate</span><span class='lparen'>(</span> <span class='symbol'>:membership_of_user_in_group</span><span class='comma'>,</span> <span class='label'>user_name:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='label'>group_name:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="user-instance_method">
  
    - (<tt>Object</tt>) <strong>user</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Access Methods to Associated User and Group</p>

<h6 id="label-"><span><a href="#label-">&para;</a> <a href="#documentation">&uarr;</a></span></h6>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user_group_membership.rb', line 228</span>

<span class='kw'>def</span> <span class='id identifier rubyid_user'>user</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_descendant'>descendant</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sat Mar 23 00:23:17 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>
